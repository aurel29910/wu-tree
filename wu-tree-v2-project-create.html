<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wu Tree - Nouvelle Branche</title>
    <link href="https://fonts.googleapis.com/css2?family=Comfortaa:wght@400;600&family=Inter:wght@400;500&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(180deg, #87CEEB 0%, #FFB6C1 100%);
            min-height: 100vh; display: flex; justify-content: center; align-items: center; overflow: hidden;
        }
        .phone-frame {
            width: 375px; height: 812px;
            background: linear-gradient(135deg, #B4E1D4 0%, #D4B4E1 50%, #F5C5D4 100%);
            border-radius: 40px; box-shadow: 0 20px 60px rgba(0,0,0,0.4);
            position: relative; overflow: hidden;
        }
        .petal { position: absolute; width: 10px; height: 10px;
            background: linear-gradient(135deg, rgba(255, 182, 193, 0.8), rgba(255, 105, 180, 0.6));
            border-radius: 50% 0 50% 0; animation: fall linear infinite; pointer-events: none; z-index: 50; }
        .petal:nth-child(1) { left: 10%; animation-duration: 12s; animation-delay: 0s; width: 8px; height: 8px; }
        .petal:nth-child(2) { left: 20%; animation-duration: 14s; animation-delay: 2s; width: 10px; height: 10px; }
        .petal:nth-child(3) { left: 30%; animation-duration: 16s; animation-delay: 4s; width: 9px; height: 9px; }
        .petal:nth-child(4) { left: 40%; animation-duration: 13s; animation-delay: 1s; width: 11px; height: 11px; }
        .petal:nth-child(5) { left: 50%; animation-duration: 15s; animation-delay: 3s; width: 8px; height: 8px; }
        .petal:nth-child(6) { left: 60%; animation-duration: 17s; animation-delay: 5s; width: 10px; height: 10px; }
        .petal:nth-child(7) { left: 70%; animation-duration: 14s; animation-delay: 6s; width: 9px; height: 9px; }
        .petal:nth-child(8) { left: 80%; animation-duration: 16s; animation-delay: 7s; width: 11px; height: 11px; }
        .petal:nth-child(9) { left: 90%; animation-duration: 13s; animation-delay: 8s; width: 8px; height: 8px; }
        .petal:nth-child(10) { left: 15%; animation-duration: 15s; animation-delay: 9s; width: 10px; height: 10px; }
        @keyframes fall { 0% { transform: translateY(-50px) rotate(0deg); opacity: 0.8; }
            100% { transform: translateY(812px) rotate(360deg); opacity: 0; } }
        .cloud { position: absolute; color: white; font-size: 50px; opacity: 0.7;
            animation: float-cloud linear infinite; pointer-events: none; z-index: 40;
            filter: drop-shadow(0 2px 8px rgba(255,255,255,0.4)); }
        .cloud:nth-child(11) { top: 60px; animation-duration: 180s; animation-delay: 0s; }
        .cloud:nth-child(12) { top: 120px; animation-duration: 220s; animation-delay: -60s; font-size: 40px; }
        .cloud:nth-child(13) { top: 180px; animation-duration: 200s; animation-delay: -120s; font-size: 45px; }
        @keyframes float-cloud { 0% { transform: translateX(-80px); } 100% { transform: translateX(455px); } }
        .status-bar { position: absolute; top: 0; left: 0; right: 0; height: 44px;
            display: flex; justify-content: space-between; align-items: center;
            padding: 0 20px; color: rgba(255,255,255,0.95); font-size: 14px; z-index: 100; }
        .content { position: relative; height: calc(100% - 44px); margin-top: 44px;
            overflow-y: auto; padding: 25px 20px; z-index: 60; }
        .header { text-align: center; margin-bottom: 20px; }
        .header-icon { font-size: 40px; margin-bottom: 10px; }
        h1 { font-family: 'Comfortaa', cursive; font-size: 24px; color: white;
            margin-bottom: 6px; text-shadow: 0 2px 8px rgba(0,0,0,0.1); }
        .subtitle { font-size: 13px; color: rgba(255,255,255,0.95); text-shadow: 0 1px 3px rgba(0,0,0,0.1); }
        .form-section { margin-bottom: 20px; }
        .form-label { display: block; font-weight: 600; font-size: 13px; color: white;
            margin-bottom: 8px; text-shadow: 0 1px 3px rgba(0,0,0,0.1); }
        .form-input { width: 100%; padding: 12px 14px; border: 2px solid rgba(255, 255, 255, 0.4);
            border-radius: 12px; font-size: 15px; background: rgba(255, 255, 255, 0.3);
            color: white; }
        .form-input:focus { outline: none; border-color: rgba(255, 255, 255, 0.7);
            background: rgba(255, 255, 255, 0.4); }
        .form-input::placeholder { color: rgba(255,255,255,0.7); }
        .emoji-picker { display: grid; grid-template-columns: repeat(8, 1fr); gap: 8px; margin-top: 8px;
            max-height: 200px; overflow-y: auto; padding: 10px; background: rgba(255,255,255,0.2);
            border-radius: 12px; }
        .emoji-option { width: 36px; height: 36px; display: flex; align-items: center;
            justify-content: center; font-size: 22px; cursor: pointer; border-radius: 8px;
            border: 2px solid transparent; background: rgba(255, 255, 255, 0.2); transition: all 0.2s; }
        .emoji-option:hover { background: rgba(255, 255, 255, 0.35); }
        .emoji-option.selected { border-color: rgba(255, 255, 255, 0.8);
            background: rgba(255, 255, 255, 0.5); transform: scale(1.1); }
        .divider { height: 1px; background: linear-gradient(90deg, transparent 0%, rgba(255,255,255,0.5) 50%, transparent 100%);
            margin: 20px 0; }
        .question-section { background: rgba(255, 255, 255, 0.25); backdrop-filter: blur(10px);
            border-radius: 14px; padding: 16px; margin-bottom: 20px; }
        .question-title { font-family: 'Comfortaa', cursive; font-size: 14px; color: white;
            margin-bottom: 4px; display: flex; align-items: center; gap: 6px; }
        .question-text { font-size: 15px; font-style: italic; color: white; line-height: 1.5;
            margin-bottom: 14px; text-shadow: 0 1px 3px rgba(0,0,0,0.1); }
        .values-list { display: flex; flex-direction: column; gap: 6px; }
        .value-option { background: rgba(255, 255, 255, 0.3); border: 2px solid transparent;
            border-radius: 10px; padding: 10px 12px; cursor: pointer; display: flex;
            align-items: center; gap: 8px; }
        .value-option.selected { border-color: rgba(255, 255, 255, 0.7);
            background: rgba(255, 255, 255, 0.5); }
        .value-option-emoji { font-size: 20px; }
        .value-option-name { font-weight: 600; font-size: 14px; color: white; }
        .value-checkbox { margin-left: auto; width: 20px; height: 20px; border-radius: 50%;
            border: 2px solid rgba(255,255,255,0.7); background: rgba(255,255,255,0.2);
            display: flex; align-items: center; justify-content: center; }
        .value-option.selected .value-checkbox { background: white; }
        .value-checkbox::after { content: '‚úì'; color: #B4A7D6; font-size: 11px;
            font-weight: bold; opacity: 0; }
        .value-option.selected .value-checkbox::after { opacity: 1; }
        .levels-section { background: rgba(255, 255, 255, 0.2); backdrop-filter: blur(10px);
            border-radius: 14px; padding: 16px; margin-bottom: 20px; }
        .levels-title { font-family: 'Comfortaa', cursive; font-size: 14px; color: white;
            margin-bottom: 8px; display: flex; align-items: center; gap: 6px; }
        .levels-subtitle { font-size: 12px; color: rgba(255,255,255,0.9); margin-bottom: 12px; }
        .level-option { background: rgba(255, 255, 255, 0.3); border: 2px solid transparent;
            border-radius: 10px; padding: 10px 12px; margin-bottom: 6px; cursor: pointer;
            display: flex; align-items: center; gap: 10px; }
        .level-option.selected { border-color: rgba(255, 255, 255, 0.7);
            background: rgba(255, 255, 255, 0.5); }
        .level-checkbox { width: 20px; height: 20px; border-radius: 4px;
            border: 2px solid rgba(255,255,255,0.7); background: rgba(255,255,255,0.2);
            display: flex; align-items: center; justify-content: center; }
        .level-option.selected .level-checkbox { background: white; }
        .level-checkbox::after { content: '‚úì'; color: #B4A7D6; font-size: 11px; opacity: 0; }
        .level-option.selected .level-checkbox::after { opacity: 1; }
        .level-info { flex: 1; }
        .level-name { font-weight: 600; font-size: 14px; color: white; }
        .level-desc { font-size: 11px; color: rgba(255,255,255,0.8); margin-top: 2px; }
        .reflection-box { background: rgba(255, 255, 255, 0.2); border-left: 3px solid rgba(255, 255, 255, 0.6);
            padding: 12px 14px; border-radius: 8px; margin-top: 12px; }
        .reflection-box p { font-size: 12px; color: white; line-height: 1.6; }
        .buttons-row { display: flex; gap: 8px; margin-top: 20px; }
        .btn { flex: 1; padding: 12px; border: none; border-radius: 12px;
            font-family: 'Comfortaa', cursive; font-size: 14px; font-weight: 600; cursor: pointer; }
        .btn-primary { background: rgba(255, 255, 255, 0.9); color: #B4A7D6;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        .btn-primary:active { transform: scale(0.98); }
        .btn-secondary { background: rgba(255, 255, 255, 0.3); color: white; }
    </style>
</head>
<body>
    <div class="phone-frame">
        <div class="petal"></div><div class="petal"></div><div class="petal"></div><div class="petal"></div><div class="petal"></div>
        <div class="petal"></div><div class="petal"></div><div class="petal"></div><div class="petal"></div><div class="petal"></div>
        <div class="cloud">‚òÅÔ∏è</div><div class="cloud">‚òÅÔ∏è</div><div class="cloud">‚òÅÔ∏è</div>
        <div class="status-bar"><span>9:41</span><span>üì∂ üîã</span></div>
        <div class="content">
            <div class="header">
                <div class="header-icon">üå±</div>
                <h1>Nouvelle Branche</h1>
                <p class="subtitle">Plante une nouvelle graine</p>
            </div>
            <div class="form-section">
                <label class="form-label">Nom du projet</label>
                <input type="text" class="form-input" id="projectName" placeholder="Ex: Trading Crypto..." maxlength="50">
            </div>
            <div class="form-section">
                <label class="form-label">Emoji</label>
                <div class="emoji-picker" id="emojiPicker"></div>
            </div>
            <div class="divider"></div>
            <div class="question-section">
                <div class="question-title"><span>üí≠</span><span>Question essentielle</span></div>
                <p class="question-text">"Quelle(s) valeur(s) ce projet vient-il nourrir ?"</p>
                <div class="values-list" id="valuesList"></div>
                <div class="reflection-box">
                    <p>üí° Si aucune valeur ne r√©sonne, ce projet est-il vraiment pour toi ?</p>
                </div>
            </div>
            <div class="levels-section">
                <div class="levels-title"><span>‚è≥</span><span>Horizons temporels</span></div>
                <p class="levels-subtitle">Active uniquement les niveaux utiles pour ce projet</p>
                <div class="level-option" onclick="toggleLevel('year')">
                    <div class="level-checkbox"></div>
                    <div class="level-info">
                        <div class="level-name">üéØ Ann√©e</div>
                        <div class="level-desc">Vision √† 12 mois</div>
                    </div>
                </div>
                <div class="level-option" onclick="toggleLevel('quarter')">
                    <div class="level-checkbox"></div>
                    <div class="level-info">
                        <div class="level-name">üìÖ Trimestre</div>
                        <div class="level-desc">√âtapes tous les 3 mois</div>
                    </div>
                </div>
                <div class="level-option" onclick="toggleLevel('month')">
                    <div class="level-checkbox"></div>
                    <div class="level-info">
                        <div class="level-name">üìÜ Mois</div>
                        <div class="level-desc">Objectifs mensuels</div>
                    </div>
                </div>
                <div class="level-option" onclick="toggleLevel('week')">
                    <div class="level-checkbox"></div>
                    <div class="level-info">
                        <div class="level-name">üìã Semaine</div>
                        <div class="level-desc">Actions hebdomadaires</div>
                    </div>
                </div>
                <div class="level-option" onclick="toggleLevel('day')">
                    <div class="level-checkbox"></div>
                    <div class="level-info">
                        <div class="level-name">‚úÖ Jour</div>
                        <div class="level-desc">T√¢ches quotidiennes</div>
                    </div>
                </div>
                <div class="reflection-box">
                    <p>üå± Aucun niveau n'est obligatoire. Choisis ce qui fait sens.</p>
                </div>
            </div>
            <div class="buttons-row">
                <button class="btn btn-secondary" onclick="cancel()">Annuler</button>
                <button class="btn btn-primary" onclick="createProject()">Cr√©er</button>
            </div>
        </div>
    </div>
    <script>
        // LARGE CHOIX D'EMOJIS
        const emojis = [
            'üéØ','‚Çø','üíº','üé®','üìö','üí™','üßò','üéµ','‚úàÔ∏è','üí°','üå±','üè†',
            'üé¨','üì±','üíª','üéÆ','üèãÔ∏è','üçé','‚òï','üöÄ','üí∞','üìà','üéì','‚ö°',
            'üî•','‚ù§Ô∏è','üåü','‚≠ê','üåà','üé™','üé≠','üé§','üé∏','üéπ','ü•Å','üé∫',
            'üì∑','üì∏','üé•','üñºÔ∏è','üñåÔ∏è','‚úçÔ∏è','üìù','üìñ','üì∞','üìä','üìâ','üíπ',
            'üèÜ','ü•á','ü•à','ü•â','üèÖ','üéñÔ∏è','üèµÔ∏è','üéóÔ∏è','üéÄ','üéÅ','üéà','üéâ',
            'üåç','üåé','üåè','üó∫Ô∏è','üß≠','‚õ∞Ô∏è','üèîÔ∏è','üåã','üóª','üèïÔ∏è','üèñÔ∏è','üèùÔ∏è'
        ];
        
        let selectedEmoji = 'üå±';
        let selectedValues = [];
        let selectedLevels = { day: false, week: false, month: false, quarter: false, year: false };
        let userValues = [];

        function loadUserValues() {
            userValues = JSON.parse(localStorage.getItem('wutree_values') || '[]');
            document.getElementById('valuesList').innerHTML = userValues.map((v, i) => `
                <div class="value-option" onclick="toggleValue(${i})">
                    <div class="value-option-emoji">${v.emoji}</div>
                    <div class="value-option-name">${v.name}</div>
                    <div class="value-checkbox"></div>
                </div>
            `).join('');
        }

        function renderEmojiPicker() {
            document.getElementById('emojiPicker').innerHTML = emojis.map(e => `
                <div class="emoji-option ${e === selectedEmoji ? 'selected' : ''}" onclick="selectEmoji('${e}')">${e}</div>
            `).join('');
        }

        function selectEmoji(e) { selectedEmoji = e; renderEmojiPicker(); }

        function toggleValue(i) {
            const opts = document.querySelectorAll('.value-option');
            const name = userValues[i].name;
            const idx = selectedValues.indexOf(name);
            if (idx !== -1) { selectedValues.splice(idx, 1); opts[i].classList.remove('selected'); }
            else { selectedValues.push(name); opts[i].classList.add('selected'); }
        }

        function toggleLevel(level) {
            selectedLevels[level] = !selectedLevels[level];
            const opts = document.querySelectorAll('.level-option');
            const levelOrder = ['year', 'quarter', 'month', 'week', 'day'];
            const idx = levelOrder.indexOf(level);
            if (selectedLevels[level]) opts[idx].classList.add('selected');
            else opts[idx].classList.remove('selected');
        }

        function createProject() {
            const name = document.getElementById('projectName').value.trim();
            if (!name) { alert('Nom du projet requis'); return; }
            if (selectedValues.length === 0) {
                if (!confirm('Ce projet ne nourrit aucune valeur. Continuer ?')) return;
            }
            const hasLevels = Object.values(selectedLevels).some(v => v);
            if (!hasLevels) { alert('Active au moins un niveau temporel'); return; }
            
            const project = {
                id: Date.now().toString(),
                name, emoji: selectedEmoji,
                values: selectedValues,
                activeLevels: selectedLevels,
                goals: { day: null, week: null, month: null, quarter: null, year: null },
                actions: [],
                createdAt: new Date().toISOString()
            };
            
            const projects = JSON.parse(localStorage.getItem('wutree_projects') || '[]');
            projects.push(project);
            localStorage.setItem('wutree_projects', JSON.stringify(projects));
            localStorage.setItem('wutree_current_project', project.id);
            window.location.href = 'wu-tree-v2-home.html';
        }

        function cancel() { window.location.href = 'wu-tree-v2-home.html'; }

        loadUserValues();
        renderEmojiPicker();
    </script>
</body>
</html>
